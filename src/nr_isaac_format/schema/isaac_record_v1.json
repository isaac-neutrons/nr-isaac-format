{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "ISAAC AI-Ready Scientific Record v1.0",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "isaac_record_version",
    "record_id",
    "record_type",
    "record_domain",
    "timestamps",
    "acquisition_source"
  ],
  "allOf": [
    {
      "if": {
        "properties": {
          "record_type": {
            "const": "evidence"
          }
        }
      },
      "then": {
        "required": [
          "descriptors"
        ]
      }
    }
  ],
  "properties": {
    "isaac_record_version": {
      "type": "string",
      "const": "1.0"
    },
    "record_id": {
      "type": "string",
      "pattern": "^[0-9A-Z]{26}$",
      "description": "ULID identifier for the record."
    },
    "record_type": {
      "type": "string",
      "enum": [
        "evidence",
        "intent",
        "synthesis"
      ],
      "description": "Fundamental nature of the record."
    },
    "record_domain": {
      "type": "string",
      "enum": [
        "characterization",
        "performance",
        "simulation",
        "theory",
        "derived"
      ],
      "description": "Scientific domain of the record content."
    },
    "timestamps": {
      "type": "object",
      "required": [
        "created_utc"
      ],
      "properties": {
        "created_utc": {
          "type": "string",
          "format": "date-time"
        },
        "acquired_start_utc": {
          "type": "string",
          "format": "date-time"
        },
        "acquired_end_utc": {
          "type": "string",
          "format": "date-time"
        }
      }
    },
    "acquisition_source": {
      "type": "object",
      "required": [
        "source_type"
      ],
      "properties": {
        "source_type": {
          "type": "string",
          "enum": [
            "facility",
            "laboratory",
            "computation",
            "literature",
            "database"
          ]
        },
        "facility": {
          "type": "object"
        },
        "laboratory": {
          "type": "object"
        },
        "computation": {
          "type": "object"
        },
        "literature": {
          "type": "object"
        }
      }
    },
    "sample": {
      "type": "object",
      "required": [
        "material",
        "sample_form"
      ],
      "properties": {
        "material": {
          "type": "object",
          "required": [
            "name",
            "formula"
          ],
          "properties": {
            "name": {
              "type": "string"
            },
            "formula": {
              "type": "string"
            },
            "provenance": {
              "type": "string"
            }
          }
        },
        "sample_form": {
          "type": "string"
        },
        "composition": {
          "type": "object"
        },
        "geometry": {
          "type": "object"
        }
      }
    },
    "system": {
      "type": "object",
      "required": [
        "domain",
        "configuration"
      ],
      "properties": {
        "domain": {
          "type": "string",
          "enum": [
            "experimental",
            "computational"
          ]
        },
        "facility": {
          "type": "object"
        },
        "instrument": {
          "type": "object"
        },
        "configuration": {
          "type": "object",
          "additionalProperties": {
            "type": [
              "string",
              "number",
              "boolean"
            ]
          },
          "description": "Flat object of categorical settings. No nested objects allowed."
        },
        "simulation": {
          "type": "object",
          "required": [
            "method"
          ],
          "properties": {
            "method": {
              "type": "string",
              "enum": [
                "DFT",
                "ab_initio_MD",
                "classical_MD",
                "kinetic_monte_carlo",
                "microkinetic_modeling",
                "machine_learning_potential"
              ]
            }
          }
        }
      }
    },
    "context": {
      "type": "object",
      "required": [
        "environment",
        "temperature_K"
      ],
      "properties": {
        "environment": {
          "type": "string"
        },
        "temperature_K": {
          "type": "number"
        }
      },
      "additionalProperties": true
    },
    "measurement": {
      "type": "object",
      "required": [
        "series",
        "qc"
      ],
      "properties": {
        "processing": {
          "type": "object"
        },
        "series": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "series_id",
              "independent_variables",
              "channels"
            ],
            "properties": {
              "series_id": {
                "type": "string"
              },
              "independent_variables": {
                "type": "array",
                "items": {
                  "type": "object",
                  "required": [
                    "name",
                    "unit"
                  ],
                  "properties": {
                    "name": {
                      "type": "string"
                    },
                    "unit": {
                      "type": "string"
                    },
                    "values": {
                      "type": "array",
                      "items": {
                        "type": "number"
                      }
                    }
                  }
                }
              },
              "channels": {
                "type": "array",
                "items": {
                  "type": "object",
                  "required": [
                    "name",
                    "unit",
                    "role"
                  ],
                  "properties": {
                    "name": {
                      "type": "string"
                    },
                    "unit": {
                      "type": "string"
                    },
                    "role": {
                      "type": "string",
                      "enum": [
                        "primary_signal",
                        "measured_response",
                        "simulated_observable",
                        "derived_signal",
                        "auxiliary_signal",
                        "control_readback",
                        "quality_monitor"
                      ]
                    },
                    "values": {
                      "type": "array",
                      "items": {
                        "type": "number"
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "qc": {
          "type": "object",
          "required": [
            "status"
          ]
        }
      }
    },
    "links": {
      "type": "array",
      "items": {
        "type": "object",
        "required": [
          "rel",
          "target"
        ],
        "properties": {
          "rel": {
            "type": "string",
            "enum": [
              "derived_from",
              "intended_comparison_target",
              "calibration_of",
              "same_sample_as",
              "replica_of",
              "follows",
              "validates",
              "invalidates"
            ]
          },
          "target": {
            "type": "string",
            "pattern": "^[0-9A-Z]{26}$"
          },
          "basis": {
            "type": "string"
          },
          "notes": {
            "type": "string"
          }
        }
      }
    },
    "assets": {
      "type": "array",
      "items": {
        "type": "object",
        "required": [
          "asset_id",
          "content_role",
          "uri",
          "sha256"
        ],
        "properties": {
          "asset_id": {
            "type": "string"
          },
          "content_role": {
            "type": "string",
            "enum": [
              "raw_data_pointer",
              "reduction_product",
              "processing_recipe",
              "input_structure",
              "metadata_snapshot",
              "supplementary_image",
              "other"
            ]
          },
          "uri": {
            "type": "string"
          },
          "sha256": {
            "type": "string"
          },
          "media_type": {
            "type": "string"
          }
        }
      }
    },
    "descriptors": {
      "type": "object",
      "required": [
        "outputs"
      ],
      "properties": {
        "policy": {
          "type": "object"
        },
        "outputs": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "label",
              "generated_utc",
              "generated_by",
              "descriptors"
            ],
            "properties": {
              "label": {
                "type": "string"
              },
              "generated_utc": {
                "type": "string"
              },
              "generated_by": {
                "type": "object"
              },
              "descriptors": {
                "type": "array",
                "items": {
                  "type": "object",
                  "required": [
                    "name",
                    "kind",
                    "source",
                    "value",
                    "uncertainty"
                  ],
                  "properties": {
                    "name": {
                      "type": "string"
                    },
                    "kind": {
                      "type": "string",
                      "enum": [
                        "absolute",
                        "differential",
                        "categorical",
                        "similarity",
                        "model"
                      ]
                    },
                    "source": {
                      "type": "string"
                    },
                    "value": {},
                    "unit": {
                      "type": "string"
                    },
                    "uncertainty": {
                      "type": "object"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "device": {
      "type": "object"
    },
    "computation": {
      "type": "object"
    },
    "literature": {
      "type": "object"
    }
  }
}
